<!DOCTYPE html>
<html>
<head>
    <title>Financial Data Visualization</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>

<div id="financialPlot" style="width:100%;height:800px;"></div>

<script>
// Assuming 'your_data.csv' is accessible at the specified path
fetch('breadthdata.csv')
    .then(response => response.text())
    .then(csvString => {
        var rows = csvString.split('\n');
        var data = rows.map(function(row) {
            return row.split(',');
        });
        
        // Extracting data
        var dates = data.slice(1).map(row => row[0]);
        var closePrices = data.slice(1).map(row => Number(row[1]) : null); // Remove commas and convert to Number
        var indexMSI = data.slice(1).map(row => row[2] ? Number(row[2]) : null);
        var macd = data.slice(1).map(row => row[3] ? Number(row[3]) : null);
        
        // Creating traces
        var closeTrace = {
            x: dates,
            y: closePrices,
            xaxis: 'x',
            yaxis: 'y',
            type: 'scatter',
            mode: 'lines',
            name: 'Close Prices'
        };

        var indexMSITrace = {
            x: dates,
            y: indexMSI,
            xaxis: 'x2',
            yaxis: 'y2',
            type: 'bar',
            name: 'Index (MSI)',
            marker: {color: 'blue'}
        };

        var macdTrace = {
            x: dates,
            y: macd,
            xaxis: 'x2',
            yaxis: 'y2',
            type: 'bar',
            name: 'MACD',
            marker: {color: 'red'}
        };

        var layout = {
            title: 'Financial Data Visualization',
            grid: {rows: 2, columns: 1, pattern: 'independent'},
            xaxis: {
                domain: [0, 1],
                title: 'Date'
            },
            yaxis: {
                title: 'Close Prices (Log Scale)',
                type: 'log'
            },
            xaxis2: {
                domain: [0, 1],
                anchor: 'y2',
                title: 'Date'
            },
            yaxis2: {
                title: 'Index (MSI) & MACD',
                anchor: 'x2'
            },
            barmode: 'overlay'
        };

        Plotly.newPlot('financialPlot', [closeTrace, indexMSITrace, macdTrace], layout);
    })
    .catch(error => console.error('Error loading the CSV file:', error));
</script>

</body>
</html>
