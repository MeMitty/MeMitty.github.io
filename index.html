<!DOCTYPE html>
<html>
<head>
    <title>Financial Data Visualization</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>

<div id="financialPlot" style="width:100%;height:1200px;"></div>

<script>
fetch('breadthdata.csv')
    .then(response => response.text())
    .then(csvString => {
        var rows = csvString.trim().split('\n');
        var headers = rows.shift().split(',');

        var parsedData = rows.map(row => {
            var values = row.split(',').map(value => value.replace(/^"|"$/g, '')); // Remove quotes from values
            var entry = {};
            headers.forEach((header, index) => {
                entry[header] = values[index];
            });
            return entry;
        });

        var dates = parsedData.map(row => row['Date']);
        var closePrices = parsedData.map(row => parseFloat(row['close'].replace(/,/g, ''))); // Convert string to float and remove commas
        var indexMSI = parsedData.map(row => row['Index (MSI)'] ? parseFloat(row['Index (MSI)'].replace(/,/g, '')) : null);
        var macd = parsedData.map(row => row['MACD'] ? parseFloat(row['MACD'].replace(/,/g, '')) : null);

        var layout = {
            title: 'Financial Data Visualization',
            grid: {rows: 3, columns: 1, pattern: 'independent'},
            xaxis: {title: 'Date'},
            yaxis: {title: 'Close Prices', type: 'log'},
            xaxis2: {title: 'Date', anchor: 'y3'},
            yaxis2: {title: 'Index (MSI)'},
            xaxis3: {title: 'Date', anchor: 'y4'},
            yaxis3: {title: 'MACD'},
        };

        var trace1 = {
            x: dates,
            y: closePrices,
            type: 'scatter',
            mode: 'lines',
            name: 'Close Prices',
            xaxis: 'x',
            yaxis: 'y'
        };

        var trace2 = {
            x: dates,
            y: indexMSI,
            type: 'bar',
            name: 'Index (MSI)',
            xaxis: 'x2',
            yaxis: 'y2'
        };

        var trace3 = {
            x: dates,
            y: macd,
            type: 'bar',
            name: 'MACD',
            xaxis: 'x3',
            yaxis: 'y3'
        };

        Plotly.newPlot('financialPlot', [trace1, trace2, trace3], layout);
    })
    .catch(error => console.error('Error loading the CSV file:', error));
</script>

</body>
</html>
