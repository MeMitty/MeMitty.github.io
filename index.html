<!DOCTYPE html>
<html>
<head>
    <title>Financial Data Visualization</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>

<div id="financialPlot" style="width:100%;height:800px;"></div>

<script>
fetch('breadthdata.csv')
    .then(response => response.text())
    .then(csvString => {
        var rows = csvString.split('\n');
        var data = rows.map(function(row) {
            return row.split(',');
        });
        
        var dates = data.slice(1).map(row => row[0]);
        var closePrices = data.slice(1).map(row => Number(row[1].replace(/,/g, '')));
        var indexMSI = data.slice(1).map(row => row[2] ? Number(row[2]) : null);
        var macd = data.slice(1).map(row => row[3] ? Number(row[3]) : null);

        var closeTrace = {
            x: dates,
            y: closePrices,
            xaxis: 'x',
            yaxis: 'y',
            type: 'scatter',
            mode: 'lines',
            name: 'Close Prices'
        };

        var indexMSITrace = {
            x: dates,
            y: indexMSI,
            xaxis: 'x2',
            yaxis: 'y2',
            type: 'bar',
            name: 'Index (MSI)',
            marker: {color: 'blue'}
        };

        var macdTrace = {
            x: dates,
            y: macd,
            xaxis: 'x2',
            yaxis: 'y2',
            type: 'bar',
            name: 'MACD',
            marker: {color: 'red'}
        };

		var layout = {
			title: 'Financial Data Visualization',
			grid: {rows: 2, columns: 1, pattern: 'independent', roworder: 'top to bottom'},
			xaxis: {
				domain: [0, 1],
				title: 'Date',
				tickmode: 'auto',
				nticks: 30, // Adjust this value to reduce or increase the number of ticks
				rangeslider: {visible: true} // Enable the range slider
			},
			yaxis: {
				title: 'Close Prices',
				type: 'log',
				autorange: true
			},
			xaxis2: {
				domain: [0, 1],
				anchor: 'y2',
				title: 'Date',
				tickmode: 'auto',
				nticks: 30, // Adjust for the second graph as well
				rangeslider: {visible: false} // Typically, a range slider is only needed on the first x-axis
			},
			yaxis2: {
				title: 'Index (MSI) & MACD',
				anchor: 'x2'
			},
			barmode: 'overlay'
		};

        Plotly.newPlot('financialPlot', [closeTrace, indexMSITrace, macdTrace], layout);
    })
    .catch(error => console.error('Error loading the CSV file:', error));
</script>

</body>
</html>
